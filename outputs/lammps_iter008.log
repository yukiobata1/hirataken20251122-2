LAMMPS (22 Jul 2025 - Update 2)
KOKKOS mode with Kokkos version 4.6.2 is enabled
  will use up to 1 GPU(s) per node
  using 1 OpenMP thread(s) per MPI task
package kokkos
# H100 GPU-Optimized LAMMPS input for EPSR simulation of EGaIn eutectic alloy
# Composition: Ga0.858In0.142
# Temperature: 150Â°C (423.15 K)
# Potential: LJ + Empirical Potential (table)
# GPU: Using KOKKOS for H100 (Hopper architecture)

# ========== KOKKOS Initialization (CRITICAL: Must be first) ==========
# CRITICAL FIX: newton off prevents KOKKOS errors on H100
# Note: pair_style table does not have /kk support, but will run on CPU while LJ runs on GPU
package         kokkos neigh full newton off

# ========== Initialization ==========
units           real
atom_style      atomic
boundary        p p p

# ========== Force field ==========
# Use hybrid/overlay to combine LJ (GPU-accelerated) and table (CPU)
# The -sf kk flag will automatically use lj/cut/kk while table runs on CPU
# NOTE: pair_style must be defined BEFORE read_data if data file contains Pair Coeffs section
pair_style      hybrid/overlay lj/cut 12.0 table linear 200

# ========== Read structure ==========
# Use LJ-equilibrated structure as initial configuration (more stable)
shell           mkdir -p outputs
# nocoeff skips Pair Coeffs section which is incompatible with hybrid/overlay
read_data       outputs/final_structure_lj_H100.data nocoeff
Reading data file ...
  orthogonal box = (0 0 0) to (73.839453 73.839453 73.839453)
  1 by 1 by 1 MPI processor grid
WARNING: Pair style lj/cut/kk in data file differs from currently defined pair style zero (src/read_data.cpp:811)
  reading atoms ...
  20000 atoms
  reading velocities ...
  20000 velocities
  read_data CPU = 0.097 seconds

# LJ potential (GPU-accelerated with -sf kk flag)
pair_coeff      1 1 lj/cut 0.430 2.70    # Ga-Ga
pair_coeff      2 2 lj/cut 0.430 3.11    # In-In
pair_coeff      1 2 lj/cut 0.430 2.905   # Ga-In

# Empirical potential (from table files - runs on CPU)
# Table format: r, U(r), F(r)
pair_coeff      1 1 table data/ep_GaGa.table EP_GAGA 12.0
pair_coeff      2 2 table data/ep_InIn.table EP_ININ 12.0
pair_coeff      1 2 table data/ep_GaIn.table EP_GAIN 12.0

# ========== Settings ==========
mass            1 69.723    # Ga
mass            2 114.818   # In

# Optimized neighbor list for GPU
neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes binsize 4.0

# ========== Initial velocity ==========
# Re-initialize velocities for this temperature
velocity        all create 423.15 12345 dist gaussian

# ========== Thermodynamic output ==========
thermo          1000
thermo_style    custom step temp pe ke etotal press vol density cpu

# ========== Quick minimization for stability ==========
print "========== Energy Minimization =========="
========== Energy Minimization ==========
minimize        1.0e-4 1.0e-6 1000 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
WARNING: Fix MINIMIZE/kk not compatible with sending data in Kokkos communication (src/KOKKOS/comm_kokkos.cpp:767)
WARNING: Fix with atom-based arrays not compatible with sending data in Kokkos communication, switching to classic exchange/border communication (src/KOKKOS/comm_kokkos.cpp:780)
WARNING: Fix MINIMIZE/kk not compatible with Kokkos sorting on device (src/KOKKOS/atom_kokkos.cpp:212)
WARNING: Fix with atom-based arrays not compatible with Kokkos sorting on device, switching to classic host sorting (src/KOKKOS/atom_kokkos.cpp:218)
Per MPI rank memory allocation (min/avg/max) = 13.71 | 13.71 | 13.71 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -1648637        25225.334     -1623411.7      47525.725      402592.25      6.2796667      0            
        14   423.15        -1672029.5      25225.334     -1646804.1      40937.124      402592.25      6.2796667      0.021934199  
Loop time of 0.0219393 on 1 procs for 14 steps with 20000 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -1648637.04782191  -1671878.08549165  -1672029.46709167
  Force two-norm initial, final = 1369.1053 138.13281
  Force max component initial, final = 42.965382 3.3542977
  Final line search alpha, max atom move = 0.0065509366 0.021973792
  Iterations, force evaluations = 14 14

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.017739   | 0.017739   | 0.017739   |   0.0 | 80.85
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00070001 | 0.00070001 | 0.00070001 |   0.0 |  3.19
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0035     |            |       | 15.95

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32437 ave       32437 max       32437 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.13998e+07 ave 1.13998e+07 max 1.13998e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11399814
Ave neighs/atom = 569.9907
Neighbor list builds = 0
Dangerous builds = 0
reset_timestep  0

# ========== RDF computation ==========
# Compute total and partial pair distribution functions
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0

# Time-average RDF output
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

# ========== Equilibration (NVT) ==========
print "========== H100 GPU Equilibration =========="
========== H100 GPU Equilibration ==========

# Start with small timestep for stability
timestep        0.5

fix             nvt all nvt temp 423.15 423.15 100.0
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.06 | 12.06 | 12.06 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -1672029.5      25225.334     -1646804.1      40937.124      402592.25      6.2796667      0            
      1000   367.94453     -1661611.1      21934.358     -1639676.7      48953.879      402592.25      6.2796667      3.0823394    
      2000   427.48807     -1658449.8      25483.941     -1632965.9      51373.277      402592.25      6.2796667      6.1464625    
      3000   420.86349     -1658667.7      25089.028     -1633578.7      51171.705      402592.25      6.2796667      9.2119681    
      4000   422.51063     -1658906.4      25187.219     -1633719.2      50966.925      402592.25      6.2796667      12.28074     
      5000   420.01272     -1658799.3      25038.311     -1633761        51293.542      402592.25      6.2796667      15.159121    
Loop time of 15.1591 on 1 procs for 5000 steps with 20000 atoms

Performance: 14.249 ns/day, 1.684 hours/ns, 329.834 timesteps/s, 6.597 Matom-step/s
99.9% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5147     | 2.5147     | 2.5147     |   0.0 | 16.59
Neigh   | 0.037891   | 0.037891   | 0.037891   |   0.0 |  0.25
Comm    | 0.050893   | 0.050893   | 0.050893   |   0.0 |  0.34
Output  | 0.0018044  | 0.0018044  | 0.0018044  |   0.0 |  0.01
Modify  | 12.383     | 12.383     | 12.383     |   0.0 | 81.69
Other   |            | 0.1706     |            |       |  1.13

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32480 ave       32480 max       32480 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:     6.8545e+06 ave  6.8545e+06 max  6.8545e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14169e+07 ave 1.14169e+07 max 1.14169e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11416946
Ave neighs/atom = 570.8473
Neighbor list builds = 23
Dangerous builds = 0
unfix           nvt

# Increase timestep to normal
timestep        2.0

fix             nvt all nvt temp 423.15 423.15 100.0
run             15000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 38.39 | 38.39 | 38.39 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
      5000   420.01272     -1658799.3      25038.311     -1633761        51293.542      402592.25      6.2796667      0            
      6000   423.11087     -1659125.7      25223.002     -1633902.7      51263.442      402592.25      6.2796667      4.1609309    
      7000   422.13988     -1659382.1      25165.117     -1634217        50952.014      402592.25      6.2796667      8.3051112    
      8000   426.06806     -1658777.2      25399.289     -1633377.9      51484.794      402592.25      6.2796667      12.461049    
      9000   420.33622     -1658369.5      25057.596     -1633311.9      51149.119      402592.25      6.2796667      16.608148    
     10000   419.19074     -1658542.6      24989.31      -1633553.3      51144.953      402592.25      6.2796667      20.770061    
     11000   418.69328     -1658803.3      24959.655     -1633843.6      51192.53       402592.25      6.2796667      24.923305    
     12000   422.20489     -1658727.1      25168.993     -1633558.1      51172.333      402592.25      6.2796667      29.079994    
     13000   422.79827     -1658690.3      25204.367     -1633485.9      51229.381      402592.25      6.2796667      33.23414     
     14000   422.4439      -1658464.9      25183.241     -1633281.7      51323.974      402592.25      6.2796667      37.395019    
     15000   424.22187     -1658688.9      25289.232     -1633399.7      51085.019      402592.25      6.2796667      41.556076    
     16000   427.08888     -1658575.9      25460.143     -1633115.8      51081.679      402592.25      6.2796667      45.707207    
     17000   421.58521     -1658797.5      25132.052     -1633665.5      51196.896      402592.25      6.2796667      49.86203     
     18000   420.94662     -1658363.1      25093.983     -1633269.1      51208.967      402592.25      6.2796667      54.017713    
     19000   425.92882     -1659039.6      25390.988     -1633648.6      51239.529      402592.25      6.2796667      58.17421     
     20000   426.34546     -1658580.3      25415.826     -1633164.4      51099.401      402592.25      6.2796667      62.327718    
Loop time of 62.3277 on 1 procs for 15000 steps with 20000 atoms

Performance: 41.587 ns/day, 0.577 hours/ns, 240.663 timesteps/s, 4.813 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5978     | 7.5978     | 7.5978     |   0.0 | 12.19
Neigh   | 0.47144    | 0.47144    | 0.47144    |   0.0 |  0.76
Comm    | 0.38097    | 0.38097    | 0.38097    |   0.0 |  0.61
Output  | 0.0054402  | 0.0054402  | 0.0054402  |   0.0 |  0.01
Modify  | 53.27      | 53.27      | 53.27      |   0.0 | 85.47
Other   |            | 0.6024     |            |       |  0.97

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32455 ave       32455 max       32455 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85366e+06 ave 6.85366e+06 max 6.85366e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14159e+07 ave 1.14159e+07 max 1.14159e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11415878
Ave neighs/atom = 570.7939
Neighbor list builds = 292
Dangerous builds = 0
unfix           nvt

# ========== Production (NVT) ==========
print "========== H100 GPU Production run =========="
========== H100 GPU Production run ==========

fix             nvt all nvt temp 423.15 423.15 100.0

# Reset RDF for production run
uncompute       myrdf
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0
unfix           rdfout
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

run             50000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.06 | 12.06 | 12.06 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
     20000   426.34546     -1658580.3      25415.826     -1633164.4      51099.401      402592.25      6.2796667      0            
     21000   424.49243     -1658568.1      25305.361     -1633262.7      51222.467      402592.25      6.2796667      4.1590353    
     22000   424.8545      -1658756.3      25326.945     -1633429.3      51343.867      402592.25      6.2796667      8.3244994    
     23000   423.79151     -1658666        25263.577     -1633402.5      51154.785      402592.25      6.2796667      12.495475    
     24000   420.59757     -1658606.1      25073.176     -1633533        51301.863      402592.25      6.2796667      16.680559    
     25000   424.80086     -1658473.4      25323.747     -1633149.7      51248.373      402592.25      6.2796667      20.849784    
     26000   420.93552     -1658839.2      25093.322     -1633745.9      51034.136      402592.25      6.2796667      25.022018    
     27000   428.17568     -1658886.6      25524.931     -1633361.7      51069.416      402592.25      6.2796667      29.187313    
     28000   422.15489     -1659056.3      25166.012     -1633890.3      51180.392      402592.25      6.2796667      33.353817    
     29000   421.98239     -1658564.8      25155.729     -1633409.1      51175.678      402592.25      6.2796667      37.51649     
     30000   426.68798     -1658799        25436.245     -1633362.8      51224.382      402592.25      6.2796667      41.681958    
     31000   422.46786     -1658763.9      25184.669     -1633579.2      51144.284      402592.25      6.2796667      45.84337     
     32000   427.00076     -1658746.4      25454.89      -1633291.5      51171.874      402592.25      6.2796667      50.008673    
     33000   423.75949     -1658654.8      25261.668     -1633393.1      51169.55       402592.25      6.2796667      54.18109     
     34000   424.7903      -1658690        25323.118     -1633366.8      51150.927      402592.25      6.2796667      58.352336    
     35000   424.67223     -1658758.4      25316.079     -1633442.3      51141.535      402592.25      6.2796667      62.517912    
     36000   425.00475     -1658405.6      25335.902     -1633069.6      51313.84       402592.25      6.2796667      66.685342    
     37000   419.39878     -1658515.8      25001.712     -1633514.1      51051.758      402592.25      6.2796667      70.860365    
     38000   421.75245     -1658371        25142.022     -1633229        51094.79       402592.25      6.2796667      75.025777    
     39000   426.81996     -1658684.2      25444.112     -1633240.1      51301.036      402592.25      6.2796667      79.190358    
     40000   424.63879     -1658561.8      25314.085     -1633247.7      51148.603      402592.25      6.2796667      83.35551     
     41000   428.90395     -1658141.4      25568.345     -1632573.1      51185.593      402592.25      6.2796667      87.52279     
     42000   421.77076     -1658598.6      25143.113     -1633455.5      50982.861      402592.25      6.2796667      91.688363    
     43000   422.03832     -1658565.5      25159.063     -1633406.4      51057.44       402592.25      6.2796667      95.872311    
     44000   423.16465     -1658475.3      25226.207     -1633249.1      51198.259      402592.25      6.2796667      100.04463    
     45000   423.94685     -1658713.1      25272.837     -1633440.3      51127.943      402592.25      6.2796667      104.20822    
     46000   420.0509      -1658827.1      25040.587     -1633786.5      50962.67       402592.25      6.2796667      108.3727     
     47000   423.54466     -1658131.9      25248.861     -1632883        51056.89       402592.25      6.2796667      112.53281    
     48000   423.54251     -1658927.2      25248.733     -1633678.5      51207.657      402592.25      6.2796667      116.69336    
     49000   420.9831      -1658487.7      25096.158     -1633391.5      51188.369      402592.25      6.2796667      120.85762    
     50000   422.27824     -1658928.6      25173.366     -1633755.3      51144.536      402592.25      6.2796667      125.01465    
     51000   421.25386     -1658408.6      25112.299     -1633296.3      51199.528      402592.25      6.2796667      129.17744    
     52000   425.24885     -1658585.8      25350.453     -1633235.3      51168.872      402592.25      6.2796667      133.34662    
     53000   426.2517      -1658389.3      25410.236     -1632979.1      51153.598      402592.25      6.2796667      137.52271    
     54000   421.87685     -1659171.1      25149.437     -1634021.7      51260.997      402592.25      6.2796667      141.69653    
     55000   423.3481      -1659013.9      25237.144     -1633776.7      51279.267      402592.25      6.2796667      145.87303    
     56000   420.35581     -1658615        25058.763     -1633556.2      51218.739      402592.25      6.2796667      150.04431    
     57000   425.50293     -1658614        25365.6       -1633248.4      51111.096      402592.25      6.2796667      154.21473    
     58000   424.77259     -1658482.1      25322.062     -1633160.1      50958.812      402592.25      6.2796667      158.37968    
     59000   426.44884     -1658638.9      25421.989     -1633216.9      51235.482      402592.25      6.2796667      162.5444     
     60000   423.38608     -1658502.2      25239.407     -1633262.8      50936.287      402592.25      6.2796667      166.71372    
     61000   421.57129     -1658825.3      25131.222     -1633694.1      51117.536      402592.25      6.2796667      170.88217    
     62000   421.29491     -1659153.1      25114.746     -1634038.4      51208.453      402592.25      6.2796667      175.048      
     63000   420.67316     -1658359.3      25077.682     -1633281.6      50965.287      402592.25      6.2796667      179.20931    
     64000   423.90086     -1658345.5      25270.095     -1633075.4      51291.103      402592.25      6.2796667      183.37785    
     65000   417.59995     -1658609.3      24894.478     -1633714.8      51029.658      402592.25      6.2796667      187.55016    
     66000   422.73512     -1658632.8      25200.602     -1633432.2      51156.526      402592.25      6.2796667      191.7073     
     67000   419.45031     -1658595        25004.784     -1633590.2      51132.217      402592.25      6.2796667      195.87398    
     68000   420.14393     -1658600.2      25046.132     -1633554.1      50985.192      402592.25      6.2796667      200.03816    
     69000   421.86576     -1659028.8      25148.777     -1633880        50857.236      402592.25      6.2796667      204.21749    
     70000   424.45991     -1659079.4      25303.422     -1633776        51172.837      402592.25      6.2796667      208.38468    
Loop time of 208.385 on 1 procs for 50000 steps with 20000 atoms

Performance: 41.462 ns/day, 0.579 hours/ns, 239.941 timesteps/s, 4.799 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.415     | 25.415     | 25.415     |   0.0 | 12.20
Neigh   | 1.5711     | 1.5711     | 1.5711     |   0.0 |  0.75
Comm    | 1.2794     | 1.2794     | 1.2794     |   0.0 |  0.61
Output  | 0.018916   | 0.018916   | 0.018916   |   0.0 |  0.01
Modify  | 178.09     | 178.09     | 178.09     |   0.0 | 85.46
Other   |            | 2.006      |            |       |  0.96

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32531 ave       32531 max       32531 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85463e+06 ave 6.85463e+06 max 6.85463e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14154e+07 ave 1.14154e+07 max 1.14154e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11415356
Ave neighs/atom = 570.7678
Neighbor list builds = 975
Dangerous builds = 0
unfix           nvt

# ========== Finalize ==========
print "========== H100 GPU Simulation completed =========="
========== H100 GPU Simulation completed ==========

# Write restart file for next iteration (use fixed name to avoid shell command issues)
write_restart   outputs/restart.0.data
System init for write_restart ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule

# Final statistics
variable        density_final equal density
variable        temp_final equal temp
variable        press_final equal press

print "========================================="
=========================================
print "FINAL RESULTS:"
FINAL RESULTS:
print "  Density:     ${density_final} g/cm^3"
  Density:     6.27966666056994 g/cm^3
print "  Temperature: ${temp_final} K"
  Temperature: 424.459913997144 K
print "  Pressure:    ${press_final} bar"
  Pressure:    51172.8365288523 bar
print "========================================="
=========================================

print "RDF written to rdf.dat"
RDF written to rdf.dat
print "Restart file written to outputs/restart.0.data"
Restart file written to outputs/restart.0.data
Total wall time: 0:04:46
