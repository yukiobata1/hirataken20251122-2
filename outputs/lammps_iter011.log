LAMMPS (22 Jul 2025 - Update 2)
KOKKOS mode with Kokkos version 4.6.2 is enabled
  will use up to 1 GPU(s) per node
  using 1 OpenMP thread(s) per MPI task
package kokkos
# H100 GPU-Optimized LAMMPS input for EPSR simulation of EGaIn eutectic alloy
# Composition: Ga0.858In0.142
# Temperature: 150Â°C (423.15 K)
# Potential: LJ + Empirical Potential (table)
# GPU: Using KOKKOS for H100 (Hopper architecture)

# ========== KOKKOS Initialization (CRITICAL: Must be first) ==========
# CRITICAL FIX: newton off prevents KOKKOS errors on H100
# Note: pair_style table does not have /kk support, but will run on CPU while LJ runs on GPU
package         kokkos neigh full newton off

# ========== Initialization ==========
units           real
atom_style      atomic
boundary        p p p

# ========== Force field ==========
# Use hybrid/overlay to combine LJ (GPU-accelerated) and table (CPU)
# The -sf kk flag will automatically use lj/cut/kk while table runs on CPU
# NOTE: pair_style must be defined BEFORE read_data if data file contains Pair Coeffs section
pair_style      hybrid/overlay lj/cut 12.0 table linear 200

# ========== Read structure ==========
# Use LJ-equilibrated structure as initial configuration (more stable)
shell           mkdir -p outputs
# nocoeff skips Pair Coeffs section which is incompatible with hybrid/overlay
read_data       outputs/final_structure_lj_H100.data nocoeff
Reading data file ...
  orthogonal box = (0 0 0) to (73.839453 73.839453 73.839453)
  1 by 1 by 1 MPI processor grid
WARNING: Pair style lj/cut/kk in data file differs from currently defined pair style zero (src/read_data.cpp:811)
  reading atoms ...
  20000 atoms
  reading velocities ...
  20000 velocities
  read_data CPU = 0.097 seconds

# LJ potential (GPU-accelerated with -sf kk flag)
pair_coeff      1 1 lj/cut 0.430 2.70    # Ga-Ga
pair_coeff      2 2 lj/cut 0.430 3.11    # In-In
pair_coeff      1 2 lj/cut 0.430 2.905   # Ga-In

# Empirical potential (from table files - runs on CPU)
# Table format: r, U(r), F(r)
pair_coeff      1 1 table data/ep_GaGa.table EP_GAGA 12.0
pair_coeff      2 2 table data/ep_InIn.table EP_ININ 12.0
pair_coeff      1 2 table data/ep_GaIn.table EP_GAIN 12.0

# ========== Settings ==========
mass            1 69.723    # Ga
mass            2 114.818   # In

# Optimized neighbor list for GPU
neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes binsize 4.0

# ========== Initial velocity ==========
# Re-initialize velocities for this temperature
velocity        all create 423.15 12345 dist gaussian

# ========== Thermodynamic output ==========
thermo          1000
thermo_style    custom step temp pe ke etotal press vol density cpu

# ========== Quick minimization for stability ==========
print "========== Energy Minimization =========="
========== Energy Minimization ==========
minimize        1.0e-4 1.0e-6 1000 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
WARNING: Fix MINIMIZE/kk not compatible with sending data in Kokkos communication (src/KOKKOS/comm_kokkos.cpp:767)
WARNING: Fix with atom-based arrays not compatible with sending data in Kokkos communication, switching to classic exchange/border communication (src/KOKKOS/comm_kokkos.cpp:780)
WARNING: Fix MINIMIZE/kk not compatible with Kokkos sorting on device (src/KOKKOS/atom_kokkos.cpp:212)
WARNING: Fix with atom-based arrays not compatible with Kokkos sorting on device, switching to classic host sorting (src/KOKKOS/atom_kokkos.cpp:218)
Per MPI rank memory allocation (min/avg/max) = 13.71 | 13.71 | 13.71 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -2340676        25225.334     -2315450.7      50978.697      402592.25      6.2796667      0            
        18   423.15        -2369433.3      25225.334     -2344207.9      45655.696      402592.25      6.2796667      0.031153121  
Loop time of 0.0311606 on 1 procs for 18 steps with 20000 atoms

99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
      -2340675.9940993  -2369226.01055619  -2369433.27130997
  Force two-norm initial, final = 1374.8248 114.45504
  Force max component initial, final = 42.978726 3.8000285
  Final line search alpha, max atom move = 0.0061984543 0.023554303
  Iterations, force evaluations = 18 18

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0226     | 0.0226     | 0.0226     |   0.0 | 72.53
Neigh   | 0.0012805  | 0.0012805  | 0.0012805  |   0.0 |  4.11
Comm    | 0.0022566  | 0.0022566  | 0.0022566  |   0.0 |  7.24
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.005023   |            |       | 16.12

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32451 ave       32451 max       32451 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14086e+07 ave 1.14086e+07 max 1.14086e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11408580
Ave neighs/atom = 570.429
Neighbor list builds = 1
Dangerous builds = 0
reset_timestep  0

# ========== RDF computation ==========
# Compute total and partial pair distribution functions
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0

# Time-average RDF output
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

# ========== Equilibration (NVT) ==========
print "========== H100 GPU Equilibration =========="
========== H100 GPU Equilibration ==========

# Start with small timestep for stability
timestep        0.5

fix             nvt all nvt temp 423.15 423.15 100.0
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.06 | 12.06 | 12.06 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -2369433.3      25225.334     -2344207.9      45655.696      402592.25      6.2796667      0            
      1000   363.69168     -2358905.3      21680.832     -2337224.4      52857.928      402592.25      6.2796667      3.0941842    
      2000   432.7846      -2355334.1      25799.684     -2329534.4      55484.461      402592.25      6.2796667      6.1827316    
      3000   421.2213      -2355975.7      25110.358     -2330865.3      55223.71       402592.25      6.2796667      9.0709075    
      4000   421.92355     -2355826.4      25152.221     -2330674.1      55041.274      402592.25      6.2796667      12.155614    
      5000   422.57366     -2356002.7      25190.976     -2330811.7      54991.613      402592.25      6.2796667      15.249283    
Loop time of 15.2493 on 1 procs for 5000 steps with 20000 atoms

Performance: 14.165 ns/day, 1.694 hours/ns, 327.884 timesteps/s, 6.558 Matom-step/s
99.9% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5148     | 2.5148     | 2.5148     |   0.0 | 16.49
Neigh   | 0.037794   | 0.037794   | 0.037794   |   0.0 |  0.25
Comm    | 0.050324   | 0.050324   | 0.050324   |   0.0 |  0.33
Output  | 0.0017821  | 0.0017821  | 0.0017821  |   0.0 |  0.01
Modify  | 12.474     | 12.474     | 12.474     |   0.0 | 81.80
Other   |            | 0.1709     |            |       |  1.12

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32437 ave       32437 max       32437 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85099e+06 ave 6.85099e+06 max 6.85099e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14114e+07 ave 1.14114e+07 max 1.14114e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11411404
Ave neighs/atom = 570.5702
Neighbor list builds = 23
Dangerous builds = 0
unfix           nvt

# Increase timestep to normal
timestep        2.0

fix             nvt all nvt temp 423.15 423.15 100.0
run             15000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 38.39 | 38.39 | 38.39 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
      5000   422.57366     -2356002.7      25190.976     -2330811.7      54991.613      402592.25      6.2796667      0            
      6000   423.41153     -2355708.6      25240.925     -2330467.7      55026.85       402592.25      6.2796667      4.1694407    
      7000   420.974       -2355753        25095.616     -2330657.4      55231.304      402592.25      6.2796667      8.3481153    
      8000   423.61097     -2355349.1      25252.814     -2330096.3      55130.62       402592.25      6.2796667      12.519804    
      9000   421.72305     -2355503        25140.269     -2330362.7      55187.447      402592.25      6.2796667      16.716118    
     10000   425.19894     -2356009.6      25347.478     -2330662.1      54950.565      402592.25      6.2796667      20.894127    
     11000   422.40841     -2355432.5      25181.126     -2330251.4      55384.475      402592.25      6.2796667      25.070443    
     12000   421.16196     -2355229        25106.821     -2330122.2      55164.397      402592.25      6.2796667      29.249197    
     13000   423.27554     -2355592.1      25232.818     -2330359.3      55065.499      402592.25      6.2796667      33.422914    
     14000   424.37253     -2355695.4      25298.213     -2330397.2      55227.868      402592.25      6.2796667      37.602215    
     15000   422.81202     -2355418.9      25205.186     -2330213.7      55142.234      402592.25      6.2796667      41.787774    
     16000   418.53574     -2356177.1      24950.263     -2331226.8      55116.557      402592.25      6.2796667      45.968032    
     17000   423.1813      -2355706.6      25227.2       -2330479.4      55225.702      402592.25      6.2796667      50.135687    
     18000   421.63055     -2355841.5      25134.755     -2330706.7      55019.689      402592.25      6.2796667      54.309559    
     19000   424.98357     -2356142        25334.639     -2330807.3      54912.716      402592.25      6.2796667      58.479779    
     20000   425.01003     -2355924        25336.217     -2330587.8      55249.41       402592.25      6.2796667      62.664759    
Loop time of 62.6648 on 1 procs for 15000 steps with 20000 atoms

Performance: 41.363 ns/day, 0.580 hours/ns, 239.369 timesteps/s, 4.787 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5694     | 7.5694     | 7.5694     |   0.0 | 12.08
Neigh   | 0.46947    | 0.46947    | 0.46947    |   0.0 |  0.75
Comm    | 0.38393    | 0.38393    | 0.38393    |   0.0 |  0.61
Output  | 0.0057315  | 0.0057315  | 0.0057315  |   0.0 |  0.01
Modify  | 53.634     | 53.634     | 53.634     |   0.0 | 85.59
Other   |            | 0.6023     |            |       |  0.96

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32440 ave       32440 max       32440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85217e+06 ave 6.85217e+06 max 6.85217e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14156e+07 ave 1.14156e+07 max 1.14156e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11415628
Ave neighs/atom = 570.7814
Neighbor list builds = 291
Dangerous builds = 0
unfix           nvt

# ========== Production (NVT) ==========
print "========== H100 GPU Production run =========="
========== H100 GPU Production run ==========

fix             nvt all nvt temp 423.15 423.15 100.0

# Reset RDF for production run
uncompute       myrdf
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0
unfix           rdfout
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

run             50000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.06 | 12.06 | 12.06 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
     20000   425.01003     -2355924        25336.217     -2330587.8      55249.41       402592.25      6.2796667      0            
     21000   426.63971     -2356204        25433.367     -2330770.6      55321.002      402592.25      6.2796667      4.1877019    
     22000   424.26818     -2354904.5      25291.993     -2329612.5      55080.527      402592.25      6.2796667      8.3855423    
     23000   427.36724     -2355763.5      25476.737     -2330286.7      55193.449      402592.25      6.2796667      12.572076    
     24000   420.19805     -2355743.2      25049.359     -2330693.8      55298.048      402592.25      6.2796667      16.757558    
     25000   423.49844     -2355705.9      25246.106     -2330459.8      55293.595      402592.25      6.2796667      20.942358    
     26000   417.70067     -2355920.5      24900.482     -2331020        55152.249      402592.25      6.2796667      25.14019     
     27000   421.37799     -2355697.3      25119.699     -2330577.6      54994.969      402592.25      6.2796667      29.326593    
     28000   424.19877     -2355637.4      25287.855     -2330349.6      55193.817      402592.25      6.2796667      33.519052    
     29000   422.62946     -2356053.2      25194.303     -2330858.9      55051.618      402592.25      6.2796667      37.701974    
     30000   423.99301     -2355457.4      25275.588     -2330181.8      55088.192      402592.25      6.2796667      41.892378    
     31000   423.74781     -2355545.9      25260.971     -2330284.9      55047.952      402592.25      6.2796667      46.083111    
     32000   421.81476     -2355465.2      25145.736     -2330319.4      55115.395      402592.25      6.2796667      50.284299    
     33000   423.23126     -2355110.2      25230.178     -2329880        55231.241      402592.25      6.2796667      54.476037    
     34000   424.64561     -2355780.1      25314.492     -2330465.6      55214.097      402592.25      6.2796667      58.660344    
     35000   423.22001     -2356181.1      25229.507     -2330951.6      55069.144      402592.25      6.2796667      62.865858    
     36000   422.61616     -2354615.9      25193.51      -2329422.4      55045.141      402592.25      6.2796667      67.059694    
     37000   425.72444     -2354830.4      25378.805     -2329451.6      55068.219      402592.25      6.2796667      71.247354    
     38000   425.9064      -2355468.8      25389.652     -2330079.1      55340.075      402592.25      6.2796667      75.446658    
     39000   423.52578     -2355191.4      25247.736     -2329943.6      55169.449      402592.25      6.2796667      79.643305    
     40000   422.29983     -2355641.2      25174.653     -2330466.5      54922.957      402592.25      6.2796667      83.829491    
     41000   424.03117     -2354675.8      25277.863     -2329398        55062.611      402592.25      6.2796667      88.027307    
     42000   425.16029     -2355665.9      25345.174     -2330320.7      55151.71       402592.25      6.2796667      92.21843     
     43000   424.10169     -2355045.9      25282.068     -2329763.8      55084.427      402592.25      6.2796667      96.415233    
     44000   422.56312     -2355029.5      25190.348     -2329839.2      55018.033      402592.25      6.2796667      100.59859    
     45000   422.51192     -2355638.3      25187.296     -2330451        55191.722      402592.25      6.2796667      104.7928     
     46000   426.60183     -2355438.5      25431.109     -2330007.4      55135.224      402592.25      6.2796667      108.98581    
     47000   420.54172     -2355515.7      25069.846     -2330445.8      54993.673      402592.25      6.2796667      113.17816    
     48000   424.0176      -2355066.9      25277.054     -2329789.8      55031.05       402592.25      6.2796667      117.37426    
     49000   425.05937     -2355229.6      25339.158     -2329890.5      55128.149      402592.25      6.2796667      121.56797    
     50000   424.97034     -2355029.5      25333.85      -2329695.7      55031.81       402592.25      6.2796667      125.76139    
     51000   422.50162     -2355547.9      25186.682     -2330361.2      55161.698      402592.25      6.2796667      129.94789    
     52000   423.29748     -2356045.3      25234.126     -2330811.2      55276.715      402592.25      6.2796667      134.12854    
     53000   424.50832     -2355165.4      25306.308     -2329859.1      55083.42       402592.25      6.2796667      138.31958    
     54000   425.31755     -2355579.1      25354.549     -2330224.5      55013.214      402592.25      6.2796667      142.49882    
     55000   420.6388      -2355097.8      25075.634     -2330022.2      54994.682      402592.25      6.2796667      146.68525    
     56000   421.85297     -2355070.3      25148.014     -2329922.3      55159.419      402592.25      6.2796667      150.87877    
     57000   420.20768     -2355580.3      25049.933     -2330530.4      54965.613      402592.25      6.2796667      155.07313    
     58000   425.76329     -2355679.5      25381.121     -2330298.3      55019.317      402592.25      6.2796667      159.25909    
     59000   417.82678     -2354592.5      24908         -2329684.5      55086.353      402592.25      6.2796667      163.44457    
     60000   424.5802      -2354467.8      25310.593     -2329157.2      55305.666      402592.25      6.2796667      167.62689    
     61000   425.5071      -2355060        25365.848     -2329694.1      54994.122      402592.25      6.2796667      171.81197    
     62000   421.84481     -2355215.1      25147.528     -2330067.6      55340.631      402592.25      6.2796667      176.01093    
     63000   422.13026     -2355292.5      25164.544     -2330128        55221.115      402592.25      6.2796667      180.2017     
     64000   418.74717     -2355544.8      24962.867     -2330581.9      55105.311      402592.25      6.2796667      184.38624    
     65000   419.93944     -2355134.6      25033.942     -2330100.6      55045.776      402592.25      6.2796667      188.56257    
     66000   425.97469     -2354527.2      25393.723     -2329133.5      55347.6        402592.25      6.2796667      192.75293    
     67000   423.5807      -2355306.8      25251.009     -2330055.8      54907.011      402592.25      6.2796667      196.94266    
     68000   424.38103     -2355225.7      25298.72      -2329927        55171.746      402592.25      6.2796667      201.13022    
     69000   420.35459     -2356038.9      25058.691     -2330980.2      55020.357      402592.25      6.2796667      205.30544    
     70000   423.39383     -2354889.8      25239.869     -2329649.9      55112.401      402592.25      6.2796667      209.50083    
Loop time of 209.501 on 1 procs for 50000 steps with 20000 atoms

Performance: 41.241 ns/day, 0.582 hours/ns, 238.662 timesteps/s, 4.773 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.381     | 25.381     | 25.381     |   0.0 | 12.12
Neigh   | 1.5649     | 1.5649     | 1.5649     |   0.0 |  0.75
Comm    | 1.2781     | 1.2781     | 1.2781     |   0.0 |  0.61
Output  | 0.018868   | 0.018868   | 0.018868   |   0.0 |  0.01
Modify  | 179.25     | 179.25     | 179.25     |   0.0 | 85.56
Other   |            | 2.009      |            |       |  0.96

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32436 ave       32436 max       32436 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.84696e+06 ave 6.84696e+06 max 6.84696e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14135e+07 ave 1.14135e+07 max 1.14135e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11413548
Ave neighs/atom = 570.6774
Neighbor list builds = 970
Dangerous builds = 0
unfix           nvt

# ========== Finalize ==========
print "========== H100 GPU Simulation completed =========="
========== H100 GPU Simulation completed ==========

# Write restart file for next iteration (use fixed name to avoid shell command issues)
write_restart   outputs/restart.0.data
System init for write_restart ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule

# Final statistics
variable        density_final equal density
variable        temp_final equal temp
variable        press_final equal press

print "========================================="
=========================================
print "FINAL RESULTS:"
FINAL RESULTS:
print "  Density:     ${density_final} g/cm^3"
  Density:     6.27966666056994 g/cm^3
print "  Temperature: ${temp_final} K"
  Temperature: 423.393825475692 K
print "  Pressure:    ${press_final} bar"
  Pressure:    55112.4005673962 bar
print "========================================="
=========================================

print "RDF written to rdf.dat"
RDF written to rdf.dat
print "Restart file written to outputs/restart.0.data"
Restart file written to outputs/restart.0.data
Total wall time: 0:04:48
