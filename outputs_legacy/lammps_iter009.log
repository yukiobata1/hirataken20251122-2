LAMMPS (22 Jul 2025 - Update 2)
KOKKOS mode with Kokkos version 4.6.2 is enabled
  will use up to 1 GPU(s) per node
  using 1 OpenMP thread(s) per MPI task
package kokkos
# H100 GPU-Optimized LAMMPS input for EPSR simulation of EGaIn eutectic alloy
# Composition: Ga0.858In0.142
# Temperature: 150Â°C (423.15 K)
# Potential: LJ + Empirical Potential (table)
# GPU: Using KOKKOS for H100 (Hopper architecture)

# ========== KOKKOS Initialization (CRITICAL: Must be first) ==========
# CRITICAL FIX: newton off prevents KOKKOS errors on H100
# Note: pair_style table does not have /kk support, but will run on CPU while LJ runs on GPU
package         kokkos neigh full newton off

# ========== Initialization ==========
units           real
atom_style      atomic
boundary        p p p

# ========== Force field ==========
# Use hybrid/overlay to combine LJ (GPU-accelerated) and table (CPU)
# The -sf kk flag will automatically use lj/cut/kk while table runs on CPU
# NOTE: pair_style must be defined BEFORE read_data if data file contains Pair Coeffs section
pair_style      hybrid/overlay lj/cut 12.0 table linear 200

# ========== Read structure ==========
# Use LJ-equilibrated structure as initial configuration (more stable)
shell           mkdir -p outputs
# nocoeff skips Pair Coeffs section which is incompatible with hybrid/overlay
read_data       outputs/final_structure_lj_H100.data nocoeff
Reading data file ...
  orthogonal box = (0 0 0) to (73.839453 73.839453 73.839453)
  1 by 1 by 1 MPI processor grid
WARNING: Pair style lj/cut/kk in data file differs from currently defined pair style zero (src/read_data.cpp:811)
  reading atoms ...
  20000 atoms
  reading velocities ...
  20000 velocities
  read_data CPU = 0.097 seconds

# LJ potential (GPU-accelerated with -sf kk flag)
pair_coeff      1 1 lj/cut 0.430 2.70    # Ga-Ga
pair_coeff      2 2 lj/cut 0.430 3.11    # In-In
pair_coeff      1 2 lj/cut 0.430 2.905   # Ga-In

# Empirical potential (from table files - runs on CPU)
# Table format: r, U(r), F(r)
pair_coeff      1 1 table data/ep_GaGa.table EP_GAGA 12.0
pair_coeff      2 2 table data/ep_InIn.table EP_ININ 12.0
pair_coeff      1 2 table data/ep_GaIn.table EP_GAIN 12.0

# ========== Settings ==========
mass            1 69.723    # Ga
mass            2 114.818   # In

# Optimized neighbor list for GPU
neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes binsize 4.0

# ========== Initial velocity ==========
# Re-initialize velocities for this temperature
velocity        all create 423.15 12345 dist gaussian

# ========== Thermodynamic output ==========
thermo          1000
thermo_style    custom step temp pe ke etotal press vol density cpu

# ========== Quick minimization for stability ==========
print "========== Energy Minimization =========="
========== Energy Minimization ==========
minimize        1.0e-4 1.0e-6 1000 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
WARNING: Fix MINIMIZE/kk not compatible with sending data in Kokkos communication (src/KOKKOS/comm_kokkos.cpp:767)
WARNING: Fix with atom-based arrays not compatible with sending data in Kokkos communication, switching to classic exchange/border communication (src/KOKKOS/comm_kokkos.cpp:780)
WARNING: Fix MINIMIZE/kk not compatible with Kokkos sorting on device (src/KOKKOS/atom_kokkos.cpp:212)
WARNING: Fix with atom-based arrays not compatible with Kokkos sorting on device, switching to classic host sorting (src/KOKKOS/atom_kokkos.cpp:218)
Per MPI rank memory allocation (min/avg/max) = 13.71 | 13.71 | 13.71 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -1879199.3      25225.334     -1853974        49032.238      402592.25      6.2796667      0            
        16   423.15        -1904726        25225.334     -1879500.7      42935.252      402592.25      6.2796667      0.024814718  
Loop time of 0.0248206 on 1 procs for 16 steps with 20000 atoms

97.9% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -1879199.30211734   -1904536.9176063   -1904725.9864516
  Force two-norm initial, final = 1370.0768 123.06721
  Force max component initial, final = 42.942325 3.49811
  Final line search alpha, max atom move = 0.0063523166 0.022221102
  Iterations, force evaluations = 16 16

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.020138   | 0.020138   | 0.020138   |   0.0 | 81.13
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00084731 | 0.00084731 | 0.00084731 |   0.0 |  3.41
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.003835   |            |       | 15.45

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32437 ave       32437 max       32437 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.13998e+07 ave 1.13998e+07 max 1.13998e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11399814
Ave neighs/atom = 569.9907
Neighbor list builds = 0
Dangerous builds = 0
reset_timestep  0

# ========== RDF computation ==========
# Compute total and partial pair distribution functions
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0

# Time-average RDF output
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

# ========== Equilibration (NVT) ==========
print "========== H100 GPU Equilibration =========="
========== H100 GPU Equilibration ==========

# Start with small timestep for stability
timestep        0.5

fix             nvt all nvt temp 423.15 423.15 100.0
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.06 | 12.06 | 12.06 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -1904726        25225.334     -1879500.7      42935.252      402592.25      6.2796667      0            
      1000   364.72293     -1894146.4      21742.309     -1872404.1      50583.078      402592.25      6.2796667      3.080458     
      2000   429.94101     -1890543.7      25630.168     -1864913.5      53089.245      402592.25      6.2796667      6.1445072    
      3000   429.66472     -1891324.5      25613.698     -1865710.8      52916.946      402592.25      6.2796667      9.0088981    
      4000   425.82717     -1891315.5      25384.929     -1865930.6      52833.038      402592.25      6.2796667      12.077381    
      5000   421.99961     -1891259.8      25156.756     -1866103        52850.672      402592.25      6.2796667      15.160959    
Loop time of 15.161 on 1 procs for 5000 steps with 20000 atoms

Performance: 14.247 ns/day, 1.685 hours/ns, 329.794 timesteps/s, 6.596 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4975     | 2.4975     | 2.4975     |   0.0 | 16.47
Neigh   | 0.037808   | 0.037808   | 0.037808   |   0.0 |  0.25
Comm    | 0.051379   | 0.051379   | 0.051379   |   0.0 |  0.34
Output  | 0.00193    | 0.00193    | 0.00193    |   0.0 |  0.01
Modify  | 12.401     | 12.401     | 12.401     |   0.0 | 81.79
Other   |            | 0.1716     |            |       |  1.13

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32466 ave       32466 max       32466 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85174e+06 ave 6.85174e+06 max 6.85174e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14152e+07 ave 1.14152e+07 max 1.14152e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11415198
Ave neighs/atom = 570.7599
Neighbor list builds = 23
Dangerous builds = 0
unfix           nvt

# Increase timestep to normal
timestep        2.0

fix             nvt all nvt temp 423.15 423.15 100.0
run             15000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 38.39 | 38.39 | 38.39 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
      5000   421.99961     -1891259.8      25156.756     -1866103        52850.672      402592.25      6.2796667      0            
      6000   422.78786     -1891011.2      25203.746     -1865807.5      52889.844      402592.25      6.2796667      4.1660469    
      7000   420.27041     -1891258        25053.673     -1866204.3      52897.804      402592.25      6.2796667      8.332554     
      8000   427.85228     -1891213.1      25505.652     -1865707.4      52844.737      402592.25      6.2796667      12.489404    
      9000   428.04108     -1891148.9      25516.907     -1865632        52709.491      402592.25      6.2796667      16.661655    
     10000   426.29144     -1890246.1      25412.605     -1864833.5      52952.721      402592.25      6.2796667      20.820436    
     11000   425.598       -1891165        25371.267     -1865793.7      52586.131      402592.25      6.2796667      24.99526     
     12000   425.58522     -1891377.9      25370.505     -1866007.4      52695.142      402592.25      6.2796667      29.155602    
     13000   421.97643     -1891198.6      25155.374     -1866043.3      52817.42       402592.25      6.2796667      33.33528     
     14000   423.28457     -1890686.7      25233.356     -1865453.4      52995.255      402592.25      6.2796667      37.498448    
     15000   421.02665     -1891563.7      25098.754     -1866465        52774.174      402592.25      6.2796667      41.671518    
     16000   423.73032     -1890779.2      25259.929     -1865519.3      52826.705      402592.25      6.2796667      45.842995    
     17000   421.29611     -1891498.9      25114.817     -1866384.1      52644.319      402592.25      6.2796667      50.00678     
     18000   427.21628     -1891913        25467.738     -1866445.3      52854.785      402592.25      6.2796667      54.169671    
     19000   421.23284     -1890264.9      25111.046     -1865153.9      52883.506      402592.25      6.2796667      58.340559    
     20000   424.29309     -1891321.6      25293.478     -1866028.1      52844.966      402592.25      6.2796667      62.497628    
Loop time of 62.4976 on 1 procs for 15000 steps with 20000 atoms

Performance: 41.474 ns/day, 0.579 hours/ns, 240.009 timesteps/s, 4.800 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5924     | 7.5924     | 7.5924     |   0.0 | 12.15
Neigh   | 0.46835    | 0.46835    | 0.46835    |   0.0 |  0.75
Comm    | 0.37906    | 0.37906    | 0.37906    |   0.0 |  0.61
Output  | 0.0057408  | 0.0057408  | 0.0057408  |   0.0 |  0.01
Modify  | 53.447     | 53.447     | 53.447     |   0.0 | 85.52
Other   |            | 0.6054     |            |       |  0.97

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32515 ave       32515 max       32515 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85033e+06 ave 6.85033e+06 max 6.85033e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14178e+07 ave 1.14178e+07 max 1.14178e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11417842
Ave neighs/atom = 570.8921
Neighbor list builds = 292
Dangerous builds = 0
unfix           nvt

# ========== Production (NVT) ==========
print "========== H100 GPU Production run =========="
========== H100 GPU Production run ==========

fix             nvt all nvt temp 423.15 423.15 100.0

# Reset RDF for production run
uncompute       myrdf
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0
unfix           rdfout
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

run             50000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.07 | 12.07 | 12.07 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
     20000   424.29309     -1891321.6      25293.478     -1866028.1      52844.966      402592.25      6.2796667      0            
     21000   423.03616     -1890989.1      25218.548     -1865770.5      52900.246      402592.25      6.2796667      4.3834982    
     22000   425.82093     -1890654.1      25384.557     -1865269.6      52831.937      402592.25      6.2796667      8.7685918    
     23000   420.3936      -1891226.1      25061.016     -1866165        52730.183      402592.25      6.2796667      13.141192    
     24000   426.98586     -1891439        25454.002     -1865985        52816.62       402592.25      6.2796667      17.521415    
     25000   420.56727     -1890309.7      25071.369     -1865238.3      52796.212      402592.25      6.2796667      21.907332    
     26000   421.04627     -1890798.2      25099.924     -1865698.3      52686.403      402592.25      6.2796667      26.282545    
     27000   420.95193     -1890729.9      25094.3       -1865635.6      52955.373      402592.25      6.2796667      30.663084    
     28000   418.38112     -1890247.9      24941.046     -1865306.9      52699.302      402592.25      6.2796667      35.041103    
     29000   421.30649     -1891199.3      25115.437     -1866083.9      52826.033      402592.25      6.2796667      39.419783    
     30000   420.37069     -1890650.9      25059.65      -1865591.2      52745.842      402592.25      6.2796667      43.790914    
     31000   426.82469     -1890821        25444.394     -1865376.6      52922.724      402592.25      6.2796667      48.164145    
     32000   422.21363     -1890928.6      25169.514     -1865759.1      52739.217      402592.25      6.2796667      52.535521    
     33000   424.47532     -1890918.7      25304.341     -1865614.4      52874.821      402592.25      6.2796667      56.905566    
     34000   423.79861     -1890587.2      25264         -1865323.2      52889.417      402592.25      6.2796667      61.284468    
     35000   424.94343     -1890742.4      25332.246     -1865410.2      53035.455      402592.25      6.2796667      65.64609     
     36000   422.20431     -1890611.6      25168.958     -1865442.7      53044.253      402592.25      6.2796667      70.029629    
     37000   421.65418     -1890766.3      25136.164     -1865630.1      52851.794      402592.25      6.2796667      74.409207    
     38000   422.02635     -1890671.5      25158.35      -1865513.1      52831.928      402592.25      6.2796667      78.792848    
     39000   421.24984     -1890549        25112.059     -1865437        53038.347      402592.25      6.2796667      83.177953    
     40000   422.08419     -1890404.3      25161.798     -1865242.5      52942.388      402592.25      6.2796667      87.548082    
     41000   422.11524     -1890502.6      25163.649     -1865339        52857.443      402592.25      6.2796667      91.924719    
     42000   421.24278     -1890339        25111.638     -1865227.4      52710.45       402592.25      6.2796667      96.288087    
     43000   422.35908     -1890713.4      25178.185     -1865535.3      52759.736      402592.25      6.2796667      100.66559    
     44000   430.0888      -1890554.5      25638.978     -1864915.6      52833.649      402592.25      6.2796667      105.03662    
     45000   424.0754      -1890717.8      25280.5       -1865437.3      52821.972      402592.25      6.2796667      109.40505    
     46000   425.04905     -1890634        25338.543     -1865295.4      52912.387      402592.25      6.2796667      113.78094    
     47000   424.60017     -1890431.4      25311.784     -1865119.6      52703.464      402592.25      6.2796667      118.16037    
     48000   422.86631     -1890671.9      25208.423     -1865463.4      52946.138      402592.25      6.2796667      122.54082    
     49000   420.99341     -1890994.5      25096.773     -1865897.7      52789.061      402592.25      6.2796667      126.91092    
     50000   421.5428      -1891196.9      25129.524     -1866067.4      52699.921      402592.25      6.2796667      131.28906    
     51000   419.36639     -1890527.3      24999.781     -1865527.5      52778.721      402592.25      6.2796667      135.65465    
     52000   425.70339     -1890569.5      25377.55      -1865192        52783.234      402592.25      6.2796667      140.02711    
     53000   424.19077     -1890856.3      25287.378     -1865568.9      53001.196      402592.25      6.2796667      144.39051    
     54000   426.84058     -1891087        25445.342     -1865641.6      52917.368      402592.25      6.2796667      148.76463    
     55000   423.26804     -1890983.2      25232.371     -1865750.8      52845.991      402592.25      6.2796667      153.13868    
     56000   421.96363     -1891181.8      25154.611     -1866027.2      52822.422      402592.25      6.2796667      157.5191     
     57000   424.12207     -1890623.1      25283.282     -1865339.8      52875.55       402592.25      6.2796667      161.90524    
     58000   422.88347     -1890581.8      25209.445     -1865372.3      53092.673      402592.25      6.2796667      166.276      
     59000   427.18397     -1890322.5      25465.812     -1864856.7      52766.253      402592.25      6.2796667      170.64852    
     60000   422.47832     -1890607        25185.293     -1865421.7      52989.558      402592.25      6.2796667      175.02234    
     61000   420.61212     -1890585.3      25074.043     -1865511.3      52947.141      402592.25      6.2796667      179.41031    
     62000   422.15529     -1890293.9      25166.036     -1865127.8      52858.764      402592.25      6.2796667      183.77545    
     63000   422.86282     -1890437.5      25208.214     -1865229.3      52849.908      402592.25      6.2796667      188.15007    
     64000   424.51918     -1891812.1      25306.955     -1866505.2      52727.485      402592.25      6.2796667      192.52384    
     65000   420.43405     -1890576.4      25063.428     -1865513        53025.366      402592.25      6.2796667      196.8941     
     66000   422.44224     -1890551.1      25183.142     -1865367.9      52949.539      402592.25      6.2796667      201.26855    
     67000   424.1539      -1890377.8      25285.18      -1865092.6      53024.741      402592.25      6.2796667      205.63992    
     68000   425.37217     -1891014.7      25357.805     -1865656.9      52832.742      402592.25      6.2796667      210.00965    
     69000   422.17685     -1890108.2      25167.321     -1864940.9      52902.219      402592.25      6.2796667      214.38516    
     70000   422.1323      -1891051.6      25164.666     -1865886.9      52720.111      402592.25      6.2796667      218.75537    
Loop time of 218.756 on 1 procs for 50000 steps with 20000 atoms

Performance: 39.496 ns/day, 0.608 hours/ns, 228.566 timesteps/s, 4.571 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.293     | 25.293     | 25.293     |   0.0 | 11.56
Neigh   | 1.5756     | 1.5756     | 1.5756     |   0.0 |  0.72
Comm    | 1.2783     | 1.2783     | 1.2783     |   0.0 |  0.58
Output  | 0.019586   | 0.019586   | 0.019586   |   0.0 |  0.01
Modify  | 188.57     | 188.57     | 188.57     |   0.0 | 86.20
Other   |            | 2.017      |            |       |  0.92

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32464 ave       32464 max       32464 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.84777e+06 ave 6.84777e+06 max 6.84777e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14154e+07 ave 1.14154e+07 max 1.14154e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11415402
Ave neighs/atom = 570.7701
Neighbor list builds = 975
Dangerous builds = 0
unfix           nvt

# ========== Finalize ==========
print "========== H100 GPU Simulation completed =========="
========== H100 GPU Simulation completed ==========

# Write restart file for next iteration (use fixed name to avoid shell command issues)
write_restart   outputs/restart.0.data
System init for write_restart ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule

# Final statistics
variable        density_final equal density
variable        temp_final equal temp
variable        press_final equal press

print "========================================="
=========================================
print "FINAL RESULTS:"
FINAL RESULTS:
print "  Density:     ${density_final} g/cm^3"
  Density:     6.27966666056993 g/cm^3
print "  Temperature: ${temp_final} K"
  Temperature: 422.132296484398 K
print "  Pressure:    ${press_final} bar"
  Pressure:    52720.1105372034 bar
print "========================================="
=========================================

print "RDF written to rdf.dat"
RDF written to rdf.dat
print "Restart file written to outputs/restart.0.data"
Restart file written to outputs/restart.0.data
Total wall time: 0:04:57
