LAMMPS (22 Jul 2025 - Update 2)
KOKKOS mode with Kokkos version 4.6.2 is enabled
  will use up to 1 GPU(s) per node
  using 1 OpenMP thread(s) per MPI task
package kokkos
# H100 GPU-Optimized LAMMPS input for EPSR simulation of EGaIn eutectic alloy
# Composition: Ga0.858In0.142
# Temperature: 150Â°C (423.15 K)
# Potential: LJ + Empirical Potential (table)
# GPU: Using KOKKOS for H100 (Hopper architecture)

# ========== KOKKOS Initialization (CRITICAL: Must be first) ==========
# CRITICAL FIX: newton off prevents KOKKOS errors on H100
# Note: pair_style table does not have /kk support, but will run on CPU while LJ runs on GPU
package         kokkos neigh full newton off

# ========== Initialization ==========
units           real
atom_style      atomic
boundary        p p p

# ========== Force field ==========
# Use hybrid/overlay to combine LJ (GPU-accelerated) and table (CPU)
# The -sf kk flag will automatically use lj/cut/kk while table runs on CPU
# NOTE: pair_style must be defined BEFORE read_data if data file contains Pair Coeffs section
pair_style      hybrid/overlay lj/cut 12.0 table linear 200

# ========== Read structure ==========
# Use LJ-equilibrated structure as initial configuration (more stable)
shell           mkdir -p outputs
# nocoeff skips Pair Coeffs section which is incompatible with hybrid/overlay
read_data       outputs/final_structure_lj_H100.data nocoeff
Reading data file ...
  orthogonal box = (0 0 0) to (73.839453 73.839453 73.839453)
  1 by 1 by 1 MPI processor grid
WARNING: Pair style lj/cut/kk in data file differs from currently defined pair style zero (src/read_data.cpp:811)
  reading atoms ...
  20000 atoms
  reading velocities ...
  20000 velocities
  read_data CPU = 0.098 seconds

# LJ potential (GPU-accelerated with -sf kk flag)
pair_coeff      1 1 lj/cut 0.430 2.70    # Ga-Ga
pair_coeff      2 2 lj/cut 0.430 3.11    # In-In
pair_coeff      1 2 lj/cut 0.430 2.905   # Ga-In

# Empirical potential (from table files - runs on CPU)
# Table format: r, U(r), F(r)
pair_coeff      1 1 table data/ep_GaGa.table EP_GAGA 12.0
pair_coeff      2 2 table data/ep_InIn.table EP_ININ 12.0
pair_coeff      1 2 table data/ep_GaIn.table EP_GAIN 12.0

# ========== Settings ==========
mass            1 69.723    # Ga
mass            2 114.818   # In

# Optimized neighbor list for GPU
neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes binsize 4.0

# ========== Initial velocity ==========
# Re-initialize velocities for this temperature
velocity        all create 423.15 12345 dist gaussian

# ========== Thermodynamic output ==========
thermo          1000
thermo_style    custom step temp pe ke etotal press vol density cpu

# ========== Quick minimization for stability ==========
print "========== Energy Minimization =========="
========== Energy Minimization ==========
minimize        1.0e-4 1.0e-6 1000 10000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
WARNING: Fix MINIMIZE/kk not compatible with sending data in Kokkos communication (src/KOKKOS/comm_kokkos.cpp:767)
WARNING: Fix with atom-based arrays not compatible with sending data in Kokkos communication, switching to classic exchange/border communication (src/KOKKOS/comm_kokkos.cpp:780)
WARNING: Fix MINIMIZE/kk not compatible with Kokkos sorting on device (src/KOKKOS/atom_kokkos.cpp:212)
WARNING: Fix with atom-based arrays not compatible with Kokkos sorting on device, switching to classic host sorting (src/KOKKOS/atom_kokkos.cpp:218)
Per MPI rank memory allocation (min/avg/max) = 13.71 | 13.71 | 13.71 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -1418260.2      25225.334     -1393034.8      45412.389      402592.25      6.2796667      0            
        18   423.15        -1442546        25225.334     -1417320.7      38425.731      402592.25      6.2796667      0.032230311  
Loop time of 0.0322375 on 1 procs for 18 steps with 20000 atoms

95.3% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -1418260.16907778  -1442455.11493132  -1442545.98830107
  Force two-norm initial, final = 1369.945 108.28889
  Force max component initial, final = 42.998227 3.2430561
  Final line search alpha, max atom move = 0.0061627391 0.019986108
  Iterations, force evaluations = 18 18

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.02305    | 0.02305    | 0.02305    |   0.0 | 71.50
Neigh   | 0.0012653  | 0.0012653  | 0.0012653  |   0.0 |  3.92
Comm    | 0.0027469  | 0.0027469  | 0.0027469  |   0.0 |  8.52
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.005175   |            |       | 16.05

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32452 ave       32452 max       32452 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14119e+07 ave 1.14119e+07 max 1.14119e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11411866
Ave neighs/atom = 570.5933
Neighbor list builds = 1
Dangerous builds = 0
reset_timestep  0

# ========== RDF computation ==========
# Compute total and partial pair distribution functions
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0

# Time-average RDF output
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

# ========== Equilibration (NVT) ==========
print "========== H100 GPU Equilibration =========="
========== H100 GPU Equilibration ==========

# Start with small timestep for stability
timestep        0.5

fix             nvt all nvt temp 423.15 423.15 100.0
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.06 | 12.06 | 12.06 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
         0   423.15        -1442546        25225.334     -1417320.7      38425.731      402592.25      6.2796667      0            
      1000   359.44121     -1430263.4      21427.448     -1408835.9      46308.998      402592.25      6.2796667      3.0908808    
      2000   431.09938     -1426368.1      25699.222     -1400668.9      49079.365      402592.25      6.2796667      6.1679807    
      3000   426.65225     -1426714.5      25434.114     -1401280.4      48908.005      402592.25      6.2796667      9.2437798    
      4000   423.01028     -1426630.4      25217.005     -1401413.4      48779.728      402592.25      6.2796667      12.331997    
      5000   424.0462      -1426780.9      25278.759     -1401502.1      48766.118      402592.25      6.2796667      15.436034    
Loop time of 15.436 on 1 procs for 5000 steps with 20000 atoms

Performance: 13.993 ns/day, 1.715 hours/ns, 323.917 timesteps/s, 6.478 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4897     | 2.4897     | 2.4897     |   0.0 | 16.13
Neigh   | 0.039148   | 0.039148   | 0.039148   |   0.0 |  0.25
Comm    | 0.052513   | 0.052513   | 0.052513   |   0.0 |  0.34
Output  | 0.0017325  | 0.0017325  | 0.0017325  |   0.0 |  0.01
Modify  | 12.681     | 12.681     | 12.681     |   0.0 | 82.15
Other   |            | 0.1717     |            |       |  1.11

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32488 ave       32488 max       32488 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.85287e+06 ave 6.85287e+06 max 6.85287e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14158e+07 ave 1.14158e+07 max 1.14158e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11415768
Ave neighs/atom = 570.7884
Neighbor list builds = 24
Dangerous builds = 0
unfix           nvt

# Increase timestep to normal
timestep        2.0

fix             nvt all nvt temp 423.15 423.15 100.0
run             15000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 38.39 | 38.39 | 38.39 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
      5000   424.0462      -1426780.9      25278.759     -1401502.1      48766.118      402592.25      6.2796667      0            
      6000   420.41701     -1426855.7      25062.412     -1401793.3      49026.042      402592.25      6.2796667      4.1708557    
      7000   427.19035     -1426942.3      25466.192     -1401476.1      48785.341      402592.25      6.2796667      8.3474365    
      8000   422.40706     -1427025.4      25181.045     -1401844.3      49002.76       402592.25      6.2796667      12.521203    
      9000   425.0673      -1426987        25339.631     -1401647.4      48741.137      402592.25      6.2796667      16.693826    
     10000   421.15477     -1426953.3      25106.392     -1401846.9      48816.758      402592.25      6.2796667      20.870841    
     11000   419.69157     -1427016.1      25019.166     -1401997        48791.611      402592.25      6.2796667      25.037582    
     12000   422.15794     -1427000.3      25166.194     -1401834.1      48596.604      402592.25      6.2796667      29.21642     
     13000   423.92585     -1426439.8      25271.585     -1401168.2      48847.248      402592.25      6.2796667      33.380826    
     14000   424.18086     -1427106.3      25286.787     -1401819.5      48764.995      402592.25      6.2796667      37.550977    
     15000   422.01732     -1426776.4      25157.811     -1401618.6      48923.718      402592.25      6.2796667      41.716152    
     16000   424.01474     -1427360.8      25276.884     -1402084        48884.565      402592.25      6.2796667      45.881929    
     17000   423.56469     -1426580.5      25250.055     -1401330.5      48841.881      402592.25      6.2796667      50.045037    
     18000   424.11902     -1426828.7      25283.1       -1401545.6      48658.255      402592.25      6.2796667      54.217505    
     19000   423.38919     -1426550.4      25239.593     -1401310.8      48780.214      402592.25      6.2796667      58.381994    
     20000   424.31852     -1426729.2      25294.994     -1401434.2      48852.628      402592.25      6.2796667      62.559618    
Loop time of 62.5596 on 1 procs for 15000 steps with 20000 atoms

Performance: 41.432 ns/day, 0.579 hours/ns, 239.771 timesteps/s, 4.795 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5687     | 7.5687     | 7.5687     |   0.0 | 12.10
Neigh   | 0.46544    | 0.46544    | 0.46544    |   0.0 |  0.74
Comm    | 0.37204    | 0.37204    | 0.37204    |   0.0 |  0.59
Output  | 0.0053772  | 0.0053772  | 0.0053772  |   0.0 |  0.01
Modify  | 53.547     | 53.547     | 53.547     |   0.0 | 85.59
Other   |            | 0.6008     |            |       |  0.96

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32468 ave       32468 max       32468 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:     6.8531e+06 ave  6.8531e+06 max  6.8531e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14193e+07 ave 1.14193e+07 max 1.14193e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11419270
Ave neighs/atom = 570.9635
Neighbor list builds = 292
Dangerous builds = 0
unfix           nvt

# ========== Production (NVT) ==========
print "========== H100 GPU Production run =========="
========== H100 GPU Production run ==========

fix             nvt all nvt temp 423.15 423.15 100.0

# Reset RDF for production run
uncompute       myrdf
compute         myrdf all rdf 200 1 1 1 2 2 2 cutoff 12.0
unfix           rdfout
fix             rdfout all ave/time 100 10 1000 c_myrdf[*] file rdf.dat mode vector

run             50000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 14
  ghost atom cutoff = 14
  binsize = 4, bins = 19 19 19
  3 neighbor lists, perpetual/occasional/extra = 2 1 0
  (1) pair lj/cut, perpetual
      attributes: full, newton off, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
  (2) pair table, perpetual, copy from (1)
      attributes: full, newton off, kokkos_device
      pair build: copy/kk/device
      stencil: none
      bin: none
  (3) compute rdf, occasional
      attributes: half, newton off
      pair build: half/bin/atomonly/newtoff
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 12.07 | 12.07 | 12.07 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density          CPU      
     20000   424.31852     -1426729.2      25294.994     -1401434.2      48852.628      402592.25      6.2796667      0            
     21000   420.1556      -1426980.6      25046.828     -1401933.8      48810.435      402592.25      6.2796667      4.1686848    
     22000   419.86644     -1426424.3      25029.591     -1401394.7      48901.411      402592.25      6.2796667      8.3323852    
     23000   421.68978     -1426747.7      25138.286     -1401609.4      48626.801      402592.25      6.2796667      12.504952    
     24000   422.28883     -1426807.8      25173.997     -1401633.8      48898.504      402592.25      6.2796667      16.675977    
     25000   424.33807     -1426333.3      25296.159     -1401037.1      48899.347      402592.25      6.2796667      20.850978    
     26000   420.73709     -1426696        25081.493     -1401614.5      48892.395      402592.25      6.2796667      25.02309     
     27000   426.1919      -1426436.4      25406.672     -1401029.7      48879.667      402592.25      6.2796667      29.196647    
     28000   427.58413     -1426818.4      25489.667     -1401328.8      48902.756      402592.25      6.2796667      33.367579    
     29000   420.91908     -1427133        25092.342     -1402040.7      48700.454      402592.25      6.2796667      37.542328    
     30000   422.30496     -1426265.7      25174.959     -1401090.7      49128.401      402592.25      6.2796667      41.71207     
     31000   422.58577     -1427097.7      25191.698     -1401906        48676.335      402592.25      6.2796667      45.885685    
     32000   424.29871     -1427176.4      25293.812     -1401882.6      48903.907      402592.25      6.2796667      50.051737    
     33000   422.33259     -1426891.1      25176.606     -1401714.5      48786.257      402592.25      6.2796667      54.224609    
     34000   423.88768     -1426298.1      25269.31      -1401028.8      49081.636      402592.25      6.2796667      58.397056    
     35000   421.32058     -1426885.6      25116.277     -1401769.3      48793.546      402592.25      6.2796667      62.574697    
     36000   424.53193     -1426884.3      25307.715     -1401576.6      48677.214      402592.25      6.2796667      66.74655     
     37000   427.72319     -1426619.9      25497.957     -1401122        48925.358      402592.25      6.2796667      70.917335    
     38000   421.84071     -1426713.7      25147.283     -1401566.5      48915.84       402592.25      6.2796667      75.086544    
     39000   418.02747     -1426394.1      24919.964     -1401474.1      48874.888      402592.25      6.2796667      79.262187    
     40000   422.3079      -1426775.1      25175.134     -1401599.9      48759.499      402592.25      6.2796667      83.442105    
     41000   417.31992     -1427244        24877.785     -1402366.2      48711.582      402592.25      6.2796667      87.614765    
     42000   419.49421     -1426914.4      25007.401     -1401907        48923.208      402592.25      6.2796667      91.785598    
     43000   423.23423     -1426785.5      25230.355     -1401555.1      48921.858      402592.25      6.2796667      95.954149    
     44000   422.23967     -1426679.6      25171.067     -1401508.5      48665.413      402592.25      6.2796667      100.11569    
     45000   428.39643     -1426773        25538.09      -1401235        48960.572      402592.25      6.2796667      104.28893    
     46000   421.88814     -1426680        25150.111     -1401529.9      48844.18       402592.25      6.2796667      108.45296    
     47000   422.86427     -1426605        25208.301     -1401396.7      48998.541      402592.25      6.2796667      112.61836    
     48000   418.90861     -1426843.3      24972.491     -1401870.8      48852.842      402592.25      6.2796667      116.79378    
     49000   424.14253     -1426629.9      25284.502     -1401345.4      49060.087      402592.25      6.2796667      120.97023    
     50000   425.71102     -1426917.6      25378.005     -1401539.6      48991.672      402592.25      6.2796667      125.13398    
     51000   420.86765     -1426303.9      25089.276     -1401214.6      48905.347      402592.25      6.2796667      129.30883    
     52000   422.46507     -1426462.5      25184.503     -1401278        48946.262      402592.25      6.2796667      133.4736     
     53000   422.36412     -1426917.2      25178.485     -1401738.7      48771.656      402592.25      6.2796667      137.64872    
     54000   422.2215      -1426692.5      25169.983     -1401522.6      48828.546      402592.25      6.2796667      141.81797    
     55000   421.16557     -1426569.9      25107.036     -1401462.9      48840.909      402592.25      6.2796667      145.9848     
     56000   419.28491     -1427125.5      24994.924     -1402130.6      48677.136      402592.25      6.2796667      150.1598     
     57000   423.56565     -1426633.3      25250.112     -1401383.2      48827.941      402592.25      6.2796667      154.32885    
     58000   422.64815     -1427192        25195.417     -1401996.6      48715.389      402592.25      6.2796667      158.50192    
     59000   422.70245     -1426904.7      25198.654     -1401706.1      48879.347      402592.25      6.2796667      162.67363    
     60000   423.5564      -1426428.5      25249.561     -1401178.9      48967.929      402592.25      6.2796667      166.84492    
     61000   423.85785     -1426746.8      25267.531     -1401479.3      48924.755      402592.25      6.2796667      171.00998    
     62000   421.79807     -1427534.5      25144.741     -1402389.8      48546.168      402592.25      6.2796667      175.19008    
     63000   426.2213      -1426772.2      25408.424     -1401363.8      48850.52       402592.25      6.2796667      179.36089    
     64000   424.26948     -1427074.2      25292.07      -1401782.1      48801.672      402592.25      6.2796667      183.53281    
     65000   422.43306     -1426726.6      25182.595     -1401544        48895.567      402592.25      6.2796667      187.70893    
     66000   426.47834     -1427109.4      25423.747     -1401685.6      48713.699      402592.25      6.2796667      191.88946    
     67000   420.29389     -1427254.9      25055.072     -1402199.8      48756.677      402592.25      6.2796667      196.06464    
     68000   421.64152     -1426946.5      25135.409     -1401811.1      48813.019      402592.25      6.2796667      200.23457    
     69000   421.97049     -1427140.9      25155.02      -1401985.8      48869.361      402592.25      6.2796667      204.40565    
     70000   420.81045     -1427002.9      25085.866     -1401917        48951.877      402592.25      6.2796667      208.58156    
Loop time of 208.582 on 1 procs for 50000 steps with 20000 atoms

Performance: 41.423 ns/day, 0.579 hours/ns, 239.714 timesteps/s, 4.794 Matom-step/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 25.216     | 25.216     | 25.216     |   0.0 | 12.09
Neigh   | 1.5799     | 1.5799     | 1.5799     |   0.0 |  0.76
Comm    | 1.2805     | 1.2805     | 1.2805     |   0.0 |  0.61
Output  | 0.018887   | 0.018887   | 0.018887   |   0.0 |  0.01
Modify  | 178.48     | 178.48     | 178.48     |   0.0 | 85.57
Other   |            | 2.01       |            |       |  0.96

Nlocal:          20000 ave       20000 max       20000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32437 ave       32437 max       32437 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    6.84981e+06 ave 6.84981e+06 max 6.84981e+06 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1.14176e+07 ave 1.14176e+07 max 1.14176e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11417574
Ave neighs/atom = 570.8787
Neighbor list builds = 980
Dangerous builds = 0
unfix           nvt

# ========== Finalize ==========
print "========== H100 GPU Simulation completed =========="
========== H100 GPU Simulation completed ==========

# Write restart file for next iteration (use fixed name to avoid shell command issues)
write_restart   outputs/restart.0.data
System init for write_restart ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule

# Final statistics
variable        density_final equal density
variable        temp_final equal temp
variable        press_final equal press

print "========================================="
=========================================
print "FINAL RESULTS:"
FINAL RESULTS:
print "  Density:     ${density_final} g/cm^3"
  Density:     6.27966666056994 g/cm^3
print "  Temperature: ${temp_final} K"
  Temperature: 420.810449635172 K
print "  Pressure:    ${press_final} bar"
  Pressure:    48951.8767779711 bar
print "========================================="
=========================================

print "RDF written to rdf.dat"
RDF written to rdf.dat
print "Restart file written to outputs/restart.0.data"
Restart file written to outputs/restart.0.data
Total wall time: 0:04:47
